# 7월 3주차 주간보고서

- [x] EMotion 인증을 위한 라우팅 설계
- [x] 스텝페이 인증 및 구독 플로우 설계
- [x] 포스트맨 셋팅
- [x] EMotion 로그인 개발
- [] mixpanel 데이터 수집 모듈 연동

## EMotion 인증을 위한 라우팅 설계

- EMotion에 로그인 인증을 위한 라우팅 구조를 설계하였습니다.
- `Main` 페이지와 `Auth` 페이지로 구분하여 설계하였습니다.

```
├── Main
│   ├── History :
│   ├── Custom : 커스텀 페이지
│   └── Motion
│   │   └── Position : 위치 모션
│   │   └── Opacity : 불투명도 모션
│   │   └── Rotate : 회전 모션
│   │   └── Scale : 크기 모션
│   └── AnchorPoint : 기준점 변경 페이지
│   └── Mypage: 마이페이지
│
├── Auth
│   ├── signin : 로그인 페이지
│   ├── subscription: 구독 종료 및 안내 페이지
│   ├── mypage : 마이페이지창
└──
```

- 초기 구조는 위와 같고 변경될 가능성이 있습니다.

## 스텝페이 인증 및 구독 플로우 설계

- 스텝페이 인증 및 구독 플로우를 설계했습니다.

### 플로우

- 회원 인증 로직
  - 1. 회원가입은 스텝페이 홈페이지에서 진행한다.
  - 2. 회원가입된 정보를 가지고 이모션에서 로그인을 진행한다.
  - 3. 스텝페이에 같은 정보가 있다면 인바이즈 데이터베이스에 추가한다.
  - 4. 로그인에 성공했다면 서버에서 ACCESS_TOKEN을 발급한다.
- 구독 로직
  - 1. 회원가입이 완료된 유저는 스텝페이 홈페이지에서 결제를 진행한다.
- 구독 인증 로직
  - 1. 로그인한 정보를 가지고 구독중인 상품명을 확인한다.
  - 2. 구독 상태라면 서비스를 사용할 수 있다.
    - 2-1.구독 상태가 아니라면 구독 종료 및 안내 페이지로 이동한다.
  - 3. 모든 결제 및 결제수단 변경, 구독 플랜 변경등의 이벤트는 스텝페이 홈페이지에서 진행한다.

> 유저정보 인증만 이모션에서 진행하고 나머지 기능들은 스텝페이 홈페이지에서 진행해야 될 것 같습니다.

## 포스트맨 셋팅

- INVAIZ X STEPPAY 팀 워크플로우를 생성하고 API 목록을 정리했습니다.
- 이후 셋팅된 API로 INVAIZ 서버와 테스트를 진행했습니다.  
  ![포스트맨](./asset//%ED%8F%AC%EC%8A%A4%ED%8A%B8%EB%A7%A8%20%EC%85%8B%ED%8C%85.png)

## EMotion 로그인 개발

- EMotion에서 로그인 기능을 개발했습니다.
- react-query 모듈을 사용해서 API 통신을 하고 서버 상태를 관리하려고 했지만 `regeneratorRuntime` 에러가 떠서 우선 `axios`로 통신한 뒤 `redux`로 상태관리를 진행했습니다.
- webpack을 직접 셋팅했기 떄문에 모듈이 추가될 때마다 설정할 것들이 많은데 CRA로 바꿀까 생각중입니다.

![로그인](./asset/%EB%8D%AE%EC%96%B4%EC%93%B0%EA%B8%B0.gif)
